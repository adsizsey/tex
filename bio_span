def relaxed_span_integrity(labels):
    """
    Checks B-I label integrity allowing 'O' in between but requiring matching entity types.
    Returns True if valid, False if there's a mismatch.
    """
    last_entity = None
    for label in labels:
        if label.startswith('B_'):
            last_entity = label[2:]
        elif label.startswith('I_'):
            if last_entity is None or label[2:] != last_entity:
                return False  # mismatch or no valid preceding B tag
        elif label == 'O':
            continue  # allow O in between
    return True
